<beans xmlns="http://www.springframework.org/schema/beans"
  xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:context="http://www.springframework.org/schema/context"
  xsi:schemaLocation="
   http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans-2.5.xsd
   http://www.springframework.org/schema/context http://www.springframework.org/schema/context/spring-context-2.5.xsd">

  <import resource="classpath:org/onebusaway/nyc/transit_data_federation/application-context.xml" />
  <context:component-scan base-package="org.onebusaway.nyc.transit_data_manager.api" />
  <context:component-scan base-package="org.onebusaway.nyc.transit_data_manager.siri" />

  <!-- This turns on automatic annotation configuration for Jackson -->
  <context:annotation-config />  

  <context:component-scan base-package="org.onebusaway.nyc.transit_data_manager.bundle.api" />
  
  <!--  why is this here? -->
  <context:component-scan base-package="org.onebusaway.nyc.vehicle_tracking.impl" />
  
  <bean
    class="org.onebusaway.container.spring.SystemPropertyOverrideConfigurer">
    <property name="order" value="-2" />
    <property name="properties">
      <props>
        <prop key="tdm.dataPath">${tdm.dataPath}</prop>
        <prop key="tdm.crewAssignsUploadDir">${tdm.crewAssignsUploadDir}</prop>
        <prop key="tdm.depotAssignsDownloadDir">${tdm.depotAssignsDownloadDir}</prop>
        <prop key="tdm.dscFilesDir">${tdm.dscFilesDir}</prop>
        <prop key="tdm.pipoFilename">${tdm.pipoFilename}</prop>
        <prop key="tdm.depotIdTranslationFile">${tdm.depotIdTranslationConfigFile}</prop>
        <prop key="tdm.prettyPrintOutput">${tdm.prettyPrintOutput}</prop>
        <prop key="tdm.vehiclepipoUploadDir">${tdm.vehiclepipoUploadDir}</prop>
      </props>
    </property>
  </bean>

  <bean
    class="org.onebusaway.nyc.transit_data_manager.config.XMLConfigurationDatastore">
    <!-- <constructor-arg value="testconfigfile.xml" /> -->
    <property name="configFilePath">
      <value>${tdm.config.configXmlFile}</value>
    </property>
  </bean>

  <bean class="org.onebusaway.nyc.transit_data_manager.bundle.BundleProvider">
    <constructor-arg ref="bundleSource" />
  </bean>

  <bean id="bundleSource"
    class="org.onebusaway.nyc.transit_data_manager.bundle.DirectoryBundleSource">
    <constructor-arg type="java.lang.String" value="${tdm.bundlePath}" />
    <constructor-arg ref="gsonTool" />
  </bean>

  <bean id="gsonTool"
    class="org.onebusaway.nyc.transit_data_manager.json.LowerCaseWDashesGsonJsonTool">
    <property name="prettyPrintOutput" value="${tdm.prettyPrintOutput}" />
  </bean>

  <bean id="siriServicePersister"
    class="org.onebusaway.nyc.transit_data_manager.siri.SiriServiceDao"></bean>

  <bean id="nycSiriService"
    class="org.onebusaway.nyc.transit_data_manager.siri.NycSiriServiceGateway">
    <property name="persister" ref="siriServicePersister" />
  </bean>

  <bean id="urlToEmbedStopIdReplace"
    class="java.lang.String">
    <constructor-arg type="java.lang.String" value="${qrBarcodes.stopIdReplaceUrl}" />
    </bean>
    
    <bean id="vehiclePullInOutService" class="org.onebusaway.nyc.transit_data_manager.api.service.VehiclePullInOutServiceImpl" />

</beans>
